CREATE OR REPLACE FUNCTION AVERAGE_SALES_PER_SALES_REPRESENTATIVE(IN REPRESENTATIVEID INT)
RETURNS avg_sales NUMERIC(10, 2)
AS
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION avg_sales := '-1';
    SELECT TO_DECIMAL(ROUND(SUM(OI.Price * OI.Quantity)/COUNT(DISTINCT SO.RepresentativeID), 2, ROUND_HALF_UP)) 
    INTO avg_sales 
    FROM OrderItem OI
    JOIN SalesOrder SO ON OI.ORDERID = SO.ORDERID
    WHERE SO.REPRESENTATIVEID = :REPRESENTATIVEID;
END;