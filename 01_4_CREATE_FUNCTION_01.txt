CREATE OR REPLACE FUNCTION AVERAGE_SALES_PER_CUSTOMER(IN CustomerID INT)
RETURNS avg_sales NUMERIC(10, 2)
AS
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION avg_sales := '-1';
    SELECT TO_DECIMAL(ROUND(SUM(OI.Price * OI.Quantity)/COUNT(DISTINCT SO.CustomerID), 2, ROUND_HALF_UP)) 
    INTO avg_sales 
    FROM SalesOrder SO
    JOIN OrderItem OI ON SO.ORDERID = OI.ORDERID;
END;